<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="es" xml:lang="es"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.4.550">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Curso LaTeX Grado Matemáticas UGR - Curso de LaTeX</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "language": {
    "search-no-results-text": "Sin resultados",
    "search-matching-documents-text": "documentos encontrados",
    "search-copy-link-title": "Copiar el enlace en la búsqueda",
    "search-hide-matches-text": "Ocultar resultados adicionales",
    "search-more-match-text": "resultado adicional en este documento",
    "search-more-matches-text": "resultados adicionales en este documento",
    "search-clear-button-title": "Borrar",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancelar",
    "search-submit-button-title": "Enviar",
    "search-label": "Buscar"
  }
}</script>


</head>

<body class="nav-sidebar docked nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a class="navbar-brand" href="./index.html">
    <span class="navbar-title">Curso LaTeX Grado Matemáticas UGR</span>
    </a>
  </div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Navegación de palanca" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item compact">
    <a class="nav-link" href="https://github.com/latex-mat-ugr/Curso-LaTeX"> <i class="bi bi-github" role="img" aria-label="GitHub">
</i> 
<span class="menu-text"></span></a>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
          <div class="quarto-navbar-tools">
</div>
      </div> <!-- /container-fluid -->
    </nav>
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Alternar barra lateral" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./about.html">Inicio</a></li></ol></nav>
        <a class="flex-grow-1" role="button" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Alternar barra lateral" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation docked overflow-auto">
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./about.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text">Inicio</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Documento sencillo/about.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Documento básico</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Matematicas/about.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Matemáticas</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Beamer/about.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Transparencias beamer</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Markdown/about.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Markdown</span></a>
  </div>
</li>
    </ul>
    </div>
<div class="quarto-sidebar-footer"><div class="sidebar-footer-item">
<p>Hecho con <a href="https://quarto.org/">Quarto</a></p>
</div></div></nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">En esta página</h2>
   
  <ul>
  <li><a href="#instalación-de-latex" id="toc-instalación-de-latex" class="nav-link active" data-scroll-target="#instalación-de-latex">Instalación de LaTeX</a>
  <ul class="collapse">
  <li><a href="#usuarios-de-windows" id="toc-usuarios-de-windows" class="nav-link" data-scroll-target="#usuarios-de-windows">Usuarios de Windows</a></li>
  <li><a href="#usuarios-de-linux" id="toc-usuarios-de-linux" class="nav-link" data-scroll-target="#usuarios-de-linux">Usuarios de Linux</a></li>
  <li><a href="#usuarios-de-macos" id="toc-usuarios-de-macos" class="nav-link" data-scroll-target="#usuarios-de-macos">Usuarios de macOS</a></li>
  <li><a href="#editores" id="toc-editores" class="nav-link" data-scroll-target="#editores">Editores</a></li>
  </ul></li>
  <li><a href="#material" id="toc-material" class="nav-link" data-scroll-target="#material">Material</a></li>
  <li><a href="#editores-de-markdown" id="toc-editores-de-markdown" class="nav-link" data-scroll-target="#editores-de-markdown">Editores de markdown</a></li>
  <li><a href="#nueva-edición-del-curso-de-latex-2021" id="toc-nueva-edición-del-curso-de-latex-2021" class="nav-link" data-scroll-target="#nueva-edición-del-curso-de-latex-2021">Nueva edición del curso de LaTeX 2021</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Curso de LaTeX</h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<p>Curso de LaTeX organizado por <a href="http://www.ugr.es/~amat/index_archivos/Page412.htm">AMAT</a> y por el PAT <a href="https://www.ugr.es/~orientamat/">Orientamat</a> para alumnos de Trabajo de Fin de Grado</p>
<p>Durante el curso 2015-16 se organizó a través de la Comisión Docente del Grado en Matemáticas</p>
<p>Los contenidos del curso se mantienen por <a href="https://www.ugr.es/~alaminos/">Jerónimo Alaminos</a>, <a href="https://www.ugr.es/~pedro">Pedro A. García Sánchez</a>, <a href="https://www.ugr.es/~ossanche">Óscar Sánchez Romero</a> y <a href="https://www.ugr.es/~ftorralbo/">Francisco Torralbo</a>.</p>
<section id="instalación-de-latex" class="level2">
<h2 class="anchored" data-anchor-id="instalación-de-latex">Instalación de LaTeX</h2>
<section id="usuarios-de-windows" class="level3">
<h3 class="anchored" data-anchor-id="usuarios-de-windows">Usuarios de Windows</h3>
<p>Una buena opción es MiKTeX. Si tenéis espacio de sobra, podéis optar por la instalación completa. En caso contrario, una instalación básica, siempre que tengamos una buena conexión a red, es suficiente. Los paquetes que falten se instalarán cuando se necesiten. En la página <a href="http://miktex.org">miktex.org</a> podéis encontrar los instaladores y más información.</p>
<p>En el curso usaremos <a href="https://www.texstudio.org/">TeXStudio</a> como editor de texto.</p>
<p><strong>Posibles problemas durante la instalación</strong>:</p>
<ul>
<li>Tras descargar el archivo de instalación de MikTeX no cambiarle el nombre. En algunos sistemas Windows esto provoca que la instalación falle.</li>
<li>A veces que la instalación para todos lo usuarios términa con un código de error. En dicho caso, intentar desinstalar y borrar la carpeta que ha creado (generalmente en <em>Archivos de Programa</em>) y reinstalar esta vez seleccionando la instalación para un único usuario.</li>
<li>Si vuestro nombre de usuario de Windows contiene acentos u espacios (p.e. <code>José</code>) la instalación de MikTeX fallará o bien no se instalará correctamente. En dicho caso la única solución que hemos encontrado hasta el momento ha sido crear un usuario nuevo cuyo nombre no contenga acentos ni espacios (p.e. <code>jose</code>), abrir sesión con dicho usuario e instalar MikTeX. Esto permitirá usar LaTeX en dicho ordenador pero sólo en la sesión del usuario que hemos creado (en el ejemplo <code>jose</code>).</li>
</ul>
</section>
<section id="usuarios-de-linux" class="level3">
<h3 class="anchored" data-anchor-id="usuarios-de-linux">Usuarios de Linux</h3>
<p>Si tenéis <a href="https://www.debian.org/index.es.html">debian</a> o <a href="http://www.ubuntu.com">Ubuntu</a>, lo podéis instalar desde la línea de comandos</p>
<pre><code>sudo apt-get install texlive</code></pre>
<p>No olvidéis hacer un <code>sudo apt-get update</code> antes.</p>
<p>En otras distribuciones de linux, la instalación es similar, pero si no sabéis usar la línea de comandos, utilizad el instalador de paquetes.</p>
<p>El único inconveniente de este método es que generalmente la distribución de TeXLive que instalaremos suele ser antigua. Para instalar la última versión podemos seguir las <a href="https://tug.org/texlive/quickinstall.html">instrucciones en su página oficial</a> o bien <a href="https://wildunix.es/posts/instalar-tex-live-en-ubuntu-mac-os-y-windows/">consultar el siguiente enlace</a>.</p>
<p>Una vez instalado TeXLive instalaremos un editor para LaTeX. En este curso usaremos <a href="https://www.texstudio.org/">TeXStudio</a>. Para instalarlo el método más sencillo es usar el gestor de paquetes de la distribución de linux que tengamos instalada. Si no lo encontramos ejecutaremos el siguiente comando en consola:</p>
<pre><code>sudo apt-get install texstudio</code></pre>
<p>Si el paquete <code>texstudio</code> no está en los repositorios los añadiremos mediante los comandos:</p>
<pre><code>sudo add-apt-repository ppa:sunderme/texstudio
sudo apt-get update</code></pre>
<p>y volveremos a intentar la instalación</p>
<pre><code>sudo apt-get install texstudio</code></pre>
</section>
<section id="usuarios-de-macos" class="level3">
<h3 class="anchored" data-anchor-id="usuarios-de-macos">Usuarios de macOS</h3>
<p>Los desarrolladores de <a href="http://pages.uoregon.edu/koch/texshop/index.html">TeXShop</a> describen en su página cómo instalar <a href="https://www.tug.org/texlive">TeX Live</a> a través de <a href="https://www.tug.org/mactex">MacTeX</a>.</p>
<p>La instalación de <a href="https://tug.org/mactex/mactex-download.html">MacTeX</a> ya incluye un editor aunque en el curso usaremos <a href="http://texstudio.sourceforge.net">TeXStudio</a>.</p>
</section>
<section id="editores" class="level3">
<h3 class="anchored" data-anchor-id="editores">Editores</h3>
<p>Existen muchos y muy buenos editores en todos los sistemas operativos arriba mencionados. Por ejemplo, la instalación de MikTeX incluye <a href="https://www.tug.org/texworks">TeXworks</a>. Y antes ya hemos mencionado TeXShop, que es un buen editor para macOS. Para Linux, <a href="https://www.gnu.org/software/emacs">emacs</a> con <a href="https://www.gnu.org/software/auctex">AUCTeX</a> o bien <a href="https://www.vim.org/">vim</a> (o su versión más moderna <a href="https://neovim.io/">neovim</a>) con <a href="https://github.com/lervag/vimtex">vimtex</a> son también buenas opciones para el usuario experto.</p>
<p>TeXworks existe en todas las plataformas que hemos mencionado.</p>
<p>Yo uso <a href="http://texstudio.sourceforge.net">TeXStudio</a>, que también es multiplataforma. Lo tengo instalado tanto en Windows como en Linux y Mac OS. Es el que utilizaremos en el curso.</p>
<p><a href="https://code.visualstudio.com/">Visual Studio Code</a> es un editor mutiplataforma con extensiones para trabajar en LaTeX. También se puede usar en un navegador.</p>
<p>Existen varias posibilidades también de editar textos en línea, una de ellas es ShareLaTeX que actualmente forma parte de <a href="https://www.overleaf.com/">Overleaf</a>.</p>
</section>
</section>
<section id="material" class="level2">
<h2 class="anchored" data-anchor-id="material">Material</h2>
<p>Podéis encontrar transparencias y material en los cursos anteriores que hemos dado bajo el Proyeccto de Innovación Docente <a href="http://www.ugr.es/~orientamat/">Orientamat</a>.</p>
<p>En esta página iremos añadiendo materiales para el curso.</p>
<ul>
<li><p>La carpeta <code>Documento sencillo</code> corresponde con la primera clase.</p></li>
<li><p><code>Libro</code> contiene un ejemplo de libro con capítulos, tabla de contenidos, índice y bibliografía.</p></li>
<li><p><code>Beamer</code> tiene dentro una presentación sencilla hecha con la clase <a href="http://www.ctan.org/tex-archive/macros/latex/contrib/beamer">beamer</a>.</p></li>
<li><p><code>Markdown</code> es una carpeta con una breve introducción a <a href="http://daringfireball.net/projects/markdown">markdown</a>.</p></li>
</ul>
<p>Cada carpeta contiene una descripción en markdown y html (obtenido a partir de la de markdown). Un ejemplo de traducción del contenido de <code>Documento sencillo</code> se puede ver <a href="http://www.ugr.es/~pedro/latex">aquí</a>.</p>
<hr>
</section>
<section id="editores-de-markdown" class="level2">
<h2 class="anchored" data-anchor-id="editores-de-markdown">Editores de markdown</h2>
<p>El editor <a href="https://atom.io">atom</a> es multiplataforma, y tiene un módulo markdown.</p>
<p><a href="https://code.visualstudio.com/">Visual Studio Code</a> puede editar y visualizar markdown, y tiene muchas extensiones para usar con markdown.</p>
<p>Para mac, un buena opción es <a href="http://macdown.uranusjr.com">MacDown</a>, que ya trae integrada <a href="http://www.mathjax.org">MathJax</a> para renderizar fórmulas en LaTeX. Atom también tiene esa posibilidad, pero hay que instalar el módulo <a href="https://atom.io/packages/markdown-preview-plus">Markdown Preview Plus</a>.</p>
<p>Existe además un plugin para <a href="https://www.google.com/chrome/browser/desktop/index.html">Chrome</a> para visualizar markdown: <a href="https://chrome.google.com/webstore/detail/markdown-preview-plus/febilkbfcbhebfnokafefeacimjdckgl">Markdown preview plus</a>. Soporta MathJax. Así que podéis usar vuestro editor de textos favorito y luego visualizar el resultado en el navegador.</p>
<p>Otra opción es usar un editor en línea, como puede ser <a href="https://stackedit.io">StackEdit</a>. También soporta MathJax.</p>
</section>
<section id="nueva-edición-del-curso-de-latex-2021" class="level2">
<h2 class="anchored" data-anchor-id="nueva-edición-del-curso-de-latex-2021">Nueva edición del curso de LaTeX 2021</h2>
<p>Este curso académico se va a impartir el curso online de LaTeX <a href="https://sites.google.com/go.ugr.es/yosigopublicando/los-cursos#h.1rvelu5hbhsq"><em>Introducción al lenguaje LaTeX para edición de textos académicos</em></a> a través de la plataforma <a href="https://sites.google.com/go.ugr.es/yosigopublicando/principal"><strong>yosigopublicando</strong></a> de la <a href="https://www.ugr.es/">Universidad de Granada</a>.</p>
<p>El material de dicho curso se encuentra disponible en el repositorio <a href="https://github.com/latex-mat-ugr/curso-virtual-2021">curso-virtual-2021</a>. Las instrucciones para el seguimiento del mismo también se encuentran en dicho repositorio.</p>


</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copiado");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copiado");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->




</body></html>